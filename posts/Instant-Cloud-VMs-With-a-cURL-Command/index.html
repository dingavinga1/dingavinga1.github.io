<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Instant Cloud VMs With a cURL Command" /><meta property="og:locale" content="en" /><meta name="description" content="Architecting and transforming modern day software with GenAI and production-ready AI-assisted data pipelines" /><meta property="og:description" content="Architecting and transforming modern day software with GenAI and production-ready AI-assisted data pipelines" /><link rel="canonical" href="https://dingavinga1.github.io/posts/Instant-Cloud-VMs-With-a-cURL-Command/" /><meta property="og:url" content="https://dingavinga1.github.io/posts/Instant-Cloud-VMs-With-a-cURL-Command/" /><meta property="og:site_name" content="Abdullah Irfan" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-02-06T12:29:00+05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Instant Cloud VMs With a cURL Command" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-02-06T12:29:00+05:00","datePublished":"2024-02-06T12:29:00+05:00","description":"Architecting and transforming modern day software with GenAI and production-ready AI-assisted data pipelines","headline":"Instant Cloud VMs With a cURL Command","mainEntityOfPage":{"@type":"WebPage","@id":"https://dingavinga1.github.io/posts/Instant-Cloud-VMs-With-a-cURL-Command/"},"url":"https://dingavinga1.github.io/posts/Instant-Cloud-VMs-With-a-cURL-Command/"}</script><title>Instant Cloud VMs With a cURL Command | Abdullah Irfan</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Abdullah Irfan"><meta name="application-name" content="Abdullah Irfan"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Abdullah Irfan</a></div><div class="site-subtitle font-italic">AI Data Engineer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/dingavinga1" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['abdullahirfan2001','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://linkedin.com/in/dingavinga" aria-label="linkedin" target="_blank" rel="noopener noreferrer"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Instant Cloud VMs With a cURL Command</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Instant Cloud VMs With a cURL Command</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1707204540" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 6, 2024 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/dingavinga1">Abdullah Irfan</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1195 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><p><a href="https://miro.medium.com/v2/resize:fit:720/format:webp/1*KG0wy_jsLaIAQONWKS0_9g.jpeg" class="popup img-link "><img data-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*KG0wy_jsLaIAQONWKS0_9g.jpeg" alt="Google Cloud Functions" class="lazyload" data-proofer-ignore></a></p><p>Cloud computing has been around for a while, and we all know its basics. Some things are easy to navigate around, and some aren’t, but I think we should all agree upon the fact that the consoles provided by Google, Azure and AWS are a bit disappointing when it comes to UX. Google is a king when it comes to the tech-verse but somehow, they managed to mess up web socket integration in their cloud portal.</p><p>Let me give an example. Go to <a href="http://console.cloud.google.com">console.cloud.google.com</a> and try to create a new Compute Engine instance. If you don’t keep reloading the page, the console won’t tell you that your instance is running. This is probably because the state isn’t being reflected in real-time. Even though this is the most nitpicky example to ever exist, there are multiple other areas where the console disappoints but let’s not get into those.</p><p>Being a perfectionist, I Googled up a solution for this (ironic, isn’t it?) and came to know about <a href="https://cloud.google.com/functions?hl=en">Cloud Functions</a>! Yes, serverless compute might just be able to help you with your problem but let’s first see what these functions really are:</p><blockquote><p>Run your code in the cloud with no servers or containers to manage with our scalable, pay-as-you-go functions as a service (FaaS) product.</p></blockquote><p>This is how Google defines cloud functions but here is what they actually are:</p><ul><li>Google Cloud Functions are mini-programs that run in the cloud.<li>They respond to events triggered by other Google Cloud services or HTTP requests.<li>You write code to define what happens when these events occur.<li>They scale automatically, meaning they can handle varying workloads without you needing to manage resources.</ul><p>Yeah… you still don’t get it do you? No judgement, I wouldn’t have either if someone pasted a ChatGPT answer in 4 bullet points. Google Cloud Functions, in the simplest terms possible, allow us to write and run code, in the cloud, without the need to manage or run a server, while heavily integrating with other Google Cloud services.</p><p><a href="https://miro.medium.com/v2/resize:fit:720/format:webp/1*wFA_0I7Ve1dUHs3hQQdoSQ.png" class="popup img-link "><img data-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*wFA_0I7Ve1dUHs3hQQdoSQ.png" alt="Cloud Services" class="lazyload" data-proofer-ignore></a></p><h2 id="advantages"><span class="mr-2">Advantages</span><a href="#advantages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>With Cloud Functions, you get:</p><ul><li><strong>Scalability</strong>: Scale you function endlessly without the need for manual intervention or even a load-balancing setup.<li><strong>Cost Effectiveness</strong>: Pay per request i.e. you only pay a small amount per hit/call on your function.</ul><h2 id="disadvantages"><span class="mr-2">Disadvantages</span><a href="#disadvantages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>If you are like me, this must’ve got you thinking that you can host your entire business using Cloud Functions and hey, maybe you can. But first, there are a few things that you cannot do with Cloud Functions:</p><ul><li><strong>10 MB</strong> limit on both HTTP request and response sizes.<li>Maximum <strong>32 GB</strong> memory available to a single cloud function<li><strong>500 MB</strong> source size, including modules.</ul><p>Now that we’ve covered the basics, how exactly can cloud functions help us get rid of our UX complaints? You might have guessed by now, but if you haven’t, here’s how- by creating your own REST API that helps you start and stop Compute Engine instances! Build your dream UI and integrate Google Cloud into it. Manage your instances without the need to reload the console page!</p><p>I don’t know if this classifies as click-bait or not but if you’re here for a tutorial on creating an entire custom web console for Google Cloud, you might be in for a disappointment. I’m just here to give you the Cloud Functions part; the rest is on you. Now, without further ado, let’s dive into how you can create/start/stop VMs, in the cloud, through a cURL command!</p><h2 id="how-do-we-create-a-cloud-function"><span class="mr-2">How do we create a Cloud Function?</span><a href="#how-do-we-create-a-cloud-function" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Navigate to <a href="http://console.cloud.google.com/functions/list">console.cloud.google.com/functions/list</a>.<li>Click on the <strong>Create Function</strong> button on the top left.<li>Give your function a name, choose your region and choose the computational limits you want to apply.<li>Click next!</ul><h2 id="what-now"><span class="mr-2">What now?</span><a href="#what-now" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Google Cloud Functions allow us to use various programming languages but I, for the purpose of this tutorial, will be using <strong>Python 3.10.</strong></p><p>First of all, we need go ahead and edit the <strong>requirements.txt</strong> file:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>functions-framework==3.*  
google-api-python-client==1.10.0
</pre></table></code></div></div><p>We need to add the second line to make sure we have the required <strong>pip</strong> module to interact with Google Cloud. Once we’re done with the pre-requisites, we can move on to writing our code in the <strong>main.py</strong> file.</p><p>Here’s what we need to start with:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="nd">@functions_framework.http</span>  
<span class="k">def</span> <span class="nf">hello_http</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>  
    <span class="sh">"""</span><span class="s">  
    Driver for cloud function  
    </span><span class="sh">"""</span>  
  
    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="sh">'</span><span class="s">OPTIONS</span><span class="sh">'</span><span class="p">:</span> <span class="c1"># letting CORS know that it's okay to hit GET/POST on this endpoint  
</span>        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>  
            <span class="sh">'</span><span class="s">Access-Control-Allow-Origin</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">*</span><span class="sh">'</span><span class="p">,</span>  
            <span class="sh">'</span><span class="s">Access-Control-Allow-Methods</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">POST</span><span class="sh">'</span><span class="p">,</span>  
            <span class="sh">'</span><span class="s">Access-Control-Allow-Headers</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Content-Type</span><span class="sh">'</span><span class="p">,</span>  
            <span class="sh">'</span><span class="s">Access-Control-Max-Age</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">3600</span><span class="sh">'</span>  
        <span class="p">}</span>  
  
        <span class="nf">return </span><span class="p">(</span><span class="sh">''</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span>   
  
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span> <span class="c1"># headers to attach to each response we send  
</span>        <span class="sh">'</span><span class="s">Access-Control-Allow-Methods</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">POST</span><span class="sh">'</span><span class="p">,</span>  
        <span class="sh">'</span><span class="s">Access-Control-Allow-Origin</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">*</span><span class="sh">'</span>  
    <span class="p">}</span>  
  
    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">json</span><span class="p">[</span><span class="sh">'</span><span class="s">operation</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">START</span><span class="sh">'</span><span class="p">:</span>  
        <span class="n">response</span> <span class="o">=</span> <span class="nf">start_vm</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">json</span><span class="p">[</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">],</span> <span class="n">headers</span><span class="p">)</span>  
    <span class="k">elif</span> <span class="n">request</span><span class="p">.</span><span class="n">json</span><span class="p">[</span><span class="sh">'</span><span class="s">operation</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">STOP</span><span class="sh">'</span><span class="p">:</span>  
        <span class="n">response</span> <span class="o">=</span> <span class="nf">stop_vm</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">json</span><span class="p">[</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">],</span> <span class="n">headers</span><span class="p">)</span>  
    <span class="k">else</span>   
        <span class="n">response</span> <span class="o">=</span> <span class="p">(</span><span class="sh">'</span><span class="s">Invalid Operation</span><span class="sh">'</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span>  
  
    <span class="k">return</span> <span class="n">response</span>
</pre></table></code></div></div><p>An apology in advance for the lack of error handling or any bad practices. You can modify the code according to your requirements as this blog is just to provide you with a basic idea of how everything works. In the driver function, we basically added a few formalities to cater to the “Same origin policy” that our browsers are so fond of (kidding, they’re there for our security).</p><p>For interacting with our compute instances, we can use the <a href="https://googleapis.github.io/google-api-python-client/docs/dyn/compute_v1.html">Google Cloud Compute SDK Reference</a>. However, here’s the code for starting and stopping a particular instance.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">start_vm</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>  

    <span class="n">project_id</span> <span class="o">=</span> <span class="sh">'</span><span class="s">&lt;YOUR PROJECT ID HERE&gt;</span><span class="sh">'</span>  
    <span class="n">zone_name</span> <span class="o">=</span> <span class="sh">'</span><span class="s">&lt;THE ZONE OF YOUR CHOICE HERE&gt;</span><span class="sh">'</span>  

    <span class="n">compute</span> <span class="o">=</span> <span class="n">googleapiclient</span><span class="p">.</span><span class="n">discovery</span><span class="p">.</span><span class="nf">build</span><span class="p">(</span><span class="sh">'</span><span class="s">compute</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">v1</span><span class="sh">'</span><span class="p">)</span>  

    <span class="n">_</span> <span class="o">=</span> <span class="n">compute</span><span class="p">.</span><span class="nf">instances</span><span class="p">().</span><span class="nf">start</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_id</span><span class="p">,</span> <span class="n">zone</span><span class="o">=</span><span class="n">zone_name</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="n">vm_name</span><span class="p">).</span><span class="nf">execute</span><span class="p">()</span>  
    <span class="n">instance_details</span> <span class="o">=</span> <span class="n">compute</span><span class="p">.</span><span class="nf">instances</span><span class="p">().</span><span class="nf">get</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_id</span><span class="p">,</span> <span class="n">zone</span><span class="o">=</span><span class="n">zone_name</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="nb">id</span><span class="p">).</span><span class="nf">execute</span><span class="p">()</span>  

    <span class="nf">return </span><span class="p">(</span><span class="n">instance</span> <span class="n">details</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span>  
  
  
<span class="k">def</span> <span class="nf">stop_vm</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>  
  
    <span class="n">project_id</span> <span class="o">=</span> <span class="sh">'</span><span class="s">&lt;YOUR PROJECT ID HERE&gt;</span><span class="sh">'</span>  
    <span class="n">zone_name</span> <span class="o">=</span> <span class="sh">'</span><span class="s">&lt;THE ZONE OF YOUR CHOICE HERE&gt;</span><span class="sh">'</span>  

    <span class="n">compute</span> <span class="o">=</span> <span class="n">googleapiclient</span><span class="p">.</span><span class="n">discovery</span><span class="p">.</span><span class="nf">build</span><span class="p">(</span><span class="sh">'</span><span class="s">compute</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">v1</span><span class="sh">'</span><span class="p">)</span>  

    <span class="n">_</span> <span class="o">=</span> <span class="n">compute</span><span class="p">.</span><span class="nf">instances</span><span class="p">().</span><span class="nf">stop</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_id</span><span class="p">,</span> <span class="n">zone</span><span class="o">=</span><span class="n">zone_name</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="n">vm_name</span><span class="p">).</span><span class="nf">execute</span><span class="p">()</span>  


    <span class="nf">return </span><span class="p">(</span><span class="sh">''</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span>
</pre></table></code></div></div><p>For the above code to work, you need to add your own project id and zone in which your instances are. Given that, if you hit test function and hit the function with the following request, you should see your instance started in the GCP Console.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>{  
  "operation": "START",  
  "id": &lt;NAME OF YOUR INSTANCE HERE&gt;  
}
</pre></table></code></div></div><p>Now, if you click on <strong>DEPLOY</strong> and try to run the same request with a cURL command, it won’t work; that’s because we haven’t allowed our function to be accessed publicly. To do that, we need to do the following:</p><ul><li>Go to <a href="https://console.cloud.google.com/run">https://console.cloud.google.com/run</a><li>Select the newly created function<li>Click on <strong>Permissions</strong><li>Click on <strong>Add Principal</strong> and select the “allUsers” principal<li>Assign it the following role: <strong>Cloud Run Invoker</strong></ul><p>Now you’re good to go! Use the following cURL command to start your cloud instances:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>curl -X POST \
  -H "Content-Type: application/json" \
  -d '{  
        "operation": "START",  
        "id": "&lt;NAME OF YOUR INSTANCE HERE&gt;"  
      }' \  
  https://&lt;URL OF YOUR CLOUD FUNCTION&gt;
</pre></table></code></div></div><h2 id="goodbye"><span class="mr-2">Goodbye</span><a href="#goodbye" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>That’s it for this blog. I hope it helps everyone who is new to Google Cloud and wants to play around with the Compute SDK!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blogs/'>Blogs</a>, <a href='/categories/cloud-computing/'>Cloud Computing</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/cloud-computing/" class="post-tag no-text-decoration" >cloud computing</a> <a href="/tags/cloud/" class="post-tag no-text-decoration" >cloud</a> <a href="/tags/public-cloud/" class="post-tag no-text-decoration" >public cloud</a> <a href="/tags/iaas/" class="post-tag no-text-decoration" >IaaS</a> <a href="/tags/google-cloud/" class="post-tag no-text-decoration" >google cloud</a> <a href="/tags/cloud-functions/" class="post-tag no-text-decoration" >cloud functions</a> <a href="/tags/lambda-functions/" class="post-tag no-text-decoration" >lambda functions</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Instant%20Cloud%20VMs%20With%20a%20chttps%3A%2F%2Fdingavinga1.github.io%2Fposts%2FInstant-Cloud-VMs-With-a-cURL-Command%2F%20Command%20-%20Abdullah%20Irfan&url=https%3A%2F%2Fdingavinga1.github.io%2Fposts%2FInstant-Cloud-VMs-With-a-cURL-Command%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Instant%20Cloud%20VMs%20With%20a%20chttps%3A%2F%2Fdingavinga1.github.io%2Fposts%2FInstant-Cloud-VMs-With-a-cURL-Command%2F%20Command%20-%20Abdullah%20Irfan&u=https%3A%2F%2Fdingavinga1.github.io%2Fposts%2FInstant-Cloud-VMs-With-a-cURL-Command%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fdingavinga1.github.io%2Fposts%2FInstant-Cloud-VMs-With-a-cURL-Command%2F&text=Instant%20Cloud%20VMs%20With%20a%20chttps%3A%2F%2Fdingavinga1.github.io%2Fposts%2FInstant-Cloud-VMs-With-a-cURL-Command%2F%20Command%20-%20Abdullah%20Irfan" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fdingavinga1.github.io%2Fposts%2FInstant-Cloud-VMs-With-a-cURL-Command%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cloud-computing/">cloud computing</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/for-dummies/">for dummies</a> <a class="post-tag" href="/tags/iaas/">IaaS</a> <a class="post-tag" href="/tags/network-security/">network security</a> <a class="post-tag" href="/tags/abstraction/">abstraction</a> <a class="post-tag" href="/tags/aspdotnet/">aspdotnet</a> <a class="post-tag" href="/tags/attacks/">attacks</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/aws/">aws</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Built-Your-Very-Own-Cloud-Storage-Right-Now!/"><div class="card-body"> <em class="small" data-ts="1683666000" data-df="ll" > May 10, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Build your Very Own Cloud Storage Right Now!</h3><div class="text-muted small"><p> Introduction When working in an organization or as a freelancer, one always faces an issue with file storage. There are millions of documents, images and important files that you need to store and ...</p></div></div></a></div><div class="card"> <a href="/posts/Fix-API-Gateway-Timeout-Errors-with-Bedrock-Agent-Invocations/"><div class="card-body"> <em class="small" data-ts="1741726800" data-df="ll" > Mar 12, 2025 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Fix API Gateway Timeout Errors with Bedrock Agent Invocations</h3><div class="text-muted small"><p> Ever since GenAI took over the tech landscape, everyone is trying to jump onto the bandwagon - some aimlessly while others trying to squeeze out the maximum potential for operational efficiency and...</p></div></div></a></div><div class="card"> <a href="/posts/Distrubuted-Log-Aggregation-Using-SQL/"><div class="card-body"> <em class="small" data-ts="1732482000" data-df="ll" > Nov 25, 2024 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Distrubuted Log Aggregation Using SQL</h3><div class="text-muted small"><p> I was talking to a friend recently and she happens to be a performance test engineer. It had been a stressful day for her because it took her an entire day to analyze some performance results. You ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Getting-Started-with-.NET-8-Core-as-a-Complete-Noob/" class="btn btn-outline-primary" prompt="Older"><p>Getting Started with .NET 8 Core as a Complete Noob</p></a> <a href="/posts/Polymorphism-Hidden-in-Plain-Sight/" class="btn btn-outline-primary" prompt="Newer"><p>Polymorphism Hidden in Plain Sight?</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cloud-computing/">cloud computing</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/for-dummies/">for dummies</a> <a class="post-tag" href="/tags/iaas/">IaaS</a> <a class="post-tag" href="/tags/network-security/">network security</a> <a class="post-tag" href="/tags/abstraction/">abstraction</a> <a class="post-tag" href="/tags/aspdotnet/">aspdotnet</a> <a class="post-tag" href="/tags/attacks/">attacks</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/aws/">aws</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://github.com/dingavinga1">Abdullah Irfan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1.11.6/dayjs.min.js,npm/dayjs@1.11.6/locale/en.min.js,npm/dayjs@1.11.6/plugin/relativeTime.min.js,npm/dayjs@1.11.6/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
