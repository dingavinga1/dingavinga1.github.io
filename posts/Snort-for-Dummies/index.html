<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Snort for Dummies!" /><meta property="og:locale" content="en" /><meta name="description" content="What is Snort?" /><meta property="og:description" content="What is Snort?" /><link rel="canonical" href="https://dingavinga1.github.io/posts/Snort-for-Dummies/" /><meta property="og:url" content="https://dingavinga1.github.io/posts/Snort-for-Dummies/" /><meta property="og:site_name" content="Abdullah Irfan" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-04-16T03:43:00+05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Snort for Dummies!" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-04-16T03:43:00+05:00","datePublished":"2023-04-16T03:43:00+05:00","description":"What is Snort?","headline":"Snort for Dummies!","mainEntityOfPage":{"@type":"WebPage","@id":"https://dingavinga1.github.io/posts/Snort-for-Dummies/"},"url":"https://dingavinga1.github.io/posts/Snort-for-Dummies/"}</script><title>Snort for Dummies! | Abdullah Irfan</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Abdullah Irfan"><meta name="application-name" content="Abdullah Irfan"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Abdullah Irfan</a></div><div class="site-subtitle font-italic">AI Data Engineer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/dingavinga1" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['abdullahirfan2001','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://linkedin.com/in/dingavinga" aria-label="linkedin" target="_blank" rel="noopener noreferrer"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Snort for Dummies!</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Snort for Dummies!</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1681598580" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 16, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/dingavinga1">Abdullah Irfan</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2325 words"> <em>12 min</em> read</span></div></div></div><div class="post-content"><h2 id="what-is-snort"><span class="mr-2">What is Snort?</span><a href="#what-is-snort" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Snort is one of the most popular open-source Intrusion Detection Systems (IDS). Snort is helpful in generating alerts based on the kind of traffic you declare unwanted for your network/host. IDS have become a vital component of network security. However, most people tend to avoid it due to complications in the configuration process. Today, I am going to try and help you install and configure Snort in the easiest way possible.</p><h2 id="installation"><span class="mr-2">Installation</span><a href="#installation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><strong>Installing dependencies</strong></p><p>Before actually installing Snort, there are a couple of pre-requisite services that we need to install in order to configure and use Snort properly.</p><ul><li>Install the basic dependencies for Snort<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt <span class="nb">install </span>build-essential libpcap-dev libpcre3-dev libnet1-dev zlib1g-dev luajit hwloclibdumbnet-dev bison flex liblzma-dev openssl libssl-dev pkg-config libhwloc-dev cmake cpputest libsqlite3-dev uuid-dev libcmocka-dev libnetfilter-queue-dev libmnl-dev autotools-dev libluajit-5.1-dev libunwind-dev libfl-dev <span class="nt">-y</span>
</pre></table></code></div></div><li>Create a new directory for Snort installation files<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">mkdir </span>install_snort <span class="o">&amp;&amp;</span> <span class="nb">cd </span>install_snort
</pre></table></code></div></div><li>Install <strong>LibDAQ</strong> (Data Acquisition Module)<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>git clone https://github.com/snort3/libdaq.git
<span class="nb">cd </span>libdaq
./bootstrap
./configure
make <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>make <span class="nb">install
cd</span> ..
</pre></table></code></div></div><li>Install <strong>TCMalloc</strong> for better concurrency and performance (optional but highly recommended for production environments)<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>wget https://github.com/gperftools/gperftools/releases/download/gperftools-2.9.1/gperftools-2.9.1.tar.gz
<span class="nb">tar </span>xzf gperftools-2.9.1.tar.gz
<span class="nb">cd </span>gperftools-2.9.1/
./configure
make <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>make <span class="nb">install
cd</span> ..
</pre></table></code></div></div><p><strong>Installing Snort</strong></p><li>Download Snort source code and building it according to your configurations. (Please note that the <code class="language-plaintext highlighter-rouge">—enable-tcmallocflag</code> can be omitted if you prefer not to use TCMalloc)<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>wget https://github.com/snort3/snort3/archive/refs/heads/master.zip
unzip master.zip
<span class="nb">cd </span>snort3-master
./configure_cmake.sh <span class="nt">--prefix</span><span class="o">=</span>/usr/local <span class="nt">--enable-tcmalloc</span>
</pre></table></code></div></div><li>Install the build<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">cd </span>build
make <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>make <span class="nb">install</span>
</pre></table></code></div></div><li>Update shared libraries to avoid any errors while trying to run Snort<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>ldconfig
</pre></table></code></div></div><li><p>Test the installation by running <code class="language-plaintext highlighter-rouge">snort -V</code>. Incase of successful installation, you will be able to see similar output to the following: ```bash</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre> ,,_     -*&gt; Snort++ &lt;*-
o"  )~   Version 3.1.58.0
 ''''    By Martin Roesch &amp; The Snort Team
         http://snort.org/contact#team
         Copyright (C) 2014-2023 Cisco and/or its affiliates. All rights reserved.
         Copyright (C) 1998-2013 Sourcefire, Inc., et al.
         Using DAQ version 3.0.11
         Using LuaJIT version 2.1.0-beta3
         Using OpenSSL 3.0.8 7 Feb 2023
         Using libpcap version 1.10.3 (with TPACKET_V3)
         Using PCRE version 8.39 2016-06-14
         Using ZLIB version 1.2.13
         Using LZMA version 5.4.1  
</pre></table></code></div></div></ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>* To test the default configuration file against Snort, run snort -c /usr/local/etc/snort/snort.lua and you will get the following result on success:
```bash
    ...
    ...
    ...
    
    Snort successfully validated the configuration (with 0 warnings).
    o")~   Snort exiting
</pre></table></code></div></div><p>Congratulations! You just successfully installed Snort.</p><h2 id="configuration"><span class="mr-2">Configuration</span><a href="#configuration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><strong>Configuring network interfaces</strong></p><p>To allow Snort to sniff and filter out network traffic, we need to put our network interface into <strong>promiscuous mode.</strong></p><ul><li>First, we need to figure out which interface we want to listen on. To list out all network interfaces, we can use the <code class="language-plaintext highlighter-rouge">ip add</code> command.<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>  1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
      <span class="nb">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
      inet 127.0.0.1/8 scope host lo
         valid_lft forever preferred_lft forever
      inet6 ::1/128 scope host 
         valid_lft forever preferred_lft forever
  2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
      <span class="nb">link</span>/ether 08:00:27:0e:34:8d brd ff:ff:ff:ff:ff:ff
      inet 10.0.2.15/24 brd 10.0.2.255 scope global dynamic noprefixroute eth0
         valid_lft 85903sec preferred_lft 85903sec
      inet6 fe80::a00:27ff:fe0e:348d/64 scope <span class="nb">link </span>noprefixroute 
         valid_lft forever preferred_lft forever
</pre></table></code></div></div><p>We will be using the <code class="language-plaintext highlighter-rouge">eth0</code> interface.</p><li>Then, we set the interface to promiscuous mode<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>ip <span class="nb">link set </span>dev eth0 promisc on
</pre></table></code></div></div><p>We also need to ensure that Generic Offloading (GRO) is turned off. To do that, we can use the following command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ethtool <span class="nt">-k</span> eth0 | <span class="nb">grep </span>receive-offload
</pre></table></code></div></div><p>In case it is turned on like this…</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>generic-receive-offload: on
large-receive-offload: off <span class="o">[</span>fixed]
</pre></table></code></div></div><p>… we need to turn it off</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>ethtool <span class="nt">-K</span> eth0 gro off lro off
</pre></table></code></div></div><p>Finally, we need to create a service to ensure our configuration is persistent across reboots.</p><li>Create a service file for Snort<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nano /etc/systemd/system/snort3-nic.service
</pre></table></code></div></div><li>Add the following lines to the file and save it ```bash [Unit] Description=Set Snort 3 NIC in promiscuous mode and Disable GRO, LRO onboot After=network.target [Service]</ul><p>Type=oneshot</p><p>ExecStart=/usr/sbin/ip link set dev eth0 promisc on</p><p>ExecStart=/usr/sbin/ethtool -K eth0 gro off lro off</p><p>TimeoutStartSec=0 RemainAfterExit=yes</p><p>[Install]</p><p>WantedBy=default.target</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>* Reload the system daemon
```bash
    sudo systemctl daemon-reload
</pre></table></code></div></div><ul><li>Finally, enable the Snort service<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>  <span class="nb">sudo </span>systemctl <span class="nb">enable</span> <span class="nt">--now</span> snort3-nic.service
</pre></table></code></div></div><li>Check the status of the service<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nv">$ </span>service snort3-nic status
● snort3-nic.service - Set Snort 3 NIC <span class="k">in </span>promiscuous mode and DisableGRO, LRO on boot
   Loaded: loaded <span class="o">(</span>/etc/systemd/system/snort3-nic.service<span class="p">;</span> enabled<span class="p">;</span>preset: disabled<span class="o">)</span>
   Active: active <span class="o">(</span>exited<span class="o">)</span> since Sun 2023-03-26 06:45:43 EDT<span class="p">;</span> 30s ago
  Process: 3143 <span class="nv">ExecStart</span><span class="o">=</span>/usr/sbin/ip <span class="nb">link set </span>dev eth0 promisc on<span class="o">(</span><span class="nv">code</span><span class="o">=</span>exited, <span class="nv">status</span><span class="o">=</span>0/SUCCESS<span class="o">)</span>
  Process: 3144 <span class="nv">ExecStart</span><span class="o">=</span>/usr/sbin/ethtool <span class="nt">-K</span> eth0 gro off lro off<span class="o">(</span><span class="nv">code</span><span class="o">=</span>exited, <span class="nv">status</span><span class="o">=</span>0/SUCCESS<span class="o">)</span>
 Main PID: 3144 <span class="o">(</span><span class="nv">code</span><span class="o">=</span>exited, <span class="nv">status</span><span class="o">=</span>0/SUCCESS<span class="o">)</span>
      CPU: 7ms
</pre></table></code></div></div><p><strong>Configuring Rules</strong></p></ul><p>To make sure the rule creation and filtering process goes smoothly, we need to create a few necessary directories and files for our rules and logs.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>su
<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="o">{</span>/usr/local/etc/rules,/usr/local/etc/so_rules/,/usr/local/etc/lists/,/var/log/snort<span class="o">}</span>
<span class="nb">touch</span> /usr/local/etc/rules/local.rules /usr/local/etc/lists/default.blocklist
<span class="nb">exit</span>
</pre></table></code></div></div><p>Then we need to add the rules to the <code class="language-plaintext highlighter-rouge">/usr/local/etc/rules/local.rules</code> as follows:</p><ol><li>Detecting DoS/DDoS attack on your web server<div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">alert</span> <span class="n">tcp</span> <span class="n">any</span> <span class="n">any</span> <span class="o">-&gt;</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">42</span> <span class="mi">80</span> <span class="p">(</span><span class="n">flags</span><span class="p">:</span><span class="n">S</span><span class="p">;</span> <span class="n">detection_filter</span><span class="p">:</span> <span class="n">track</span> <span class="n">by_src</span><span class="p">,</span> <span class="n">count</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seconds</span> <span class="mi">10</span><span class="p">;</span> <span class="n">msg</span><span class="p">:</span><span class="s2">"Possible SYN Flood Attack"</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">1000001</span><span class="p">;)</span>
</pre></table></code></div></div><li>Detecting SQL Injection attack on your web server<div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">alert</span> <span class="n">tcp</span> <span class="n">any</span> <span class="n">any</span> <span class="o">-&gt;</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">42</span> <span class="mi">80</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">"Possible SQL injection attack detected"</span><span class="p">;</span> <span class="n">flow</span><span class="p">:</span><span class="n">to_server</span><span class="p">,</span><span class="n">established</span><span class="p">;</span> <span class="n">content</span><span class="p">:</span> <span class="s2">"%27"</span> <span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">100002</span><span class="p">;</span> <span class="n">rev</span><span class="p">:</span><span class="mi">1</span><span class="p">;)</span>
</pre></table></code></div></div><li>Detecting Port Scanning activity<div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">alert</span> <span class="n">tcp</span> <span class="n">any</span> <span class="n">any</span> <span class="o">-&gt;</span> <span class="n">any</span> <span class="n">any</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">"Port scanning detected"</span><span class="p">;</span> <span class="n">flags</span><span class="p">:</span><span class="n">S</span><span class="p">;</span> <span class="n">detection_filter</span><span class="p">:</span><span class="n">track</span> <span class="n">by_src</span><span class="p">,</span> <span class="n">count</span> <span class="mi">3</span><span class="p">,</span> <span class="n">seconds</span> <span class="mi">10</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">100003</span><span class="p">;</span> <span class="n">rev</span><span class="p">:</span><span class="mi">1</span><span class="p">;)</span>
</pre></table></code></div></div><li>Detecting Network Interception attempts<div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">alert</span> <span class="n">ip</span> <span class="n">any</span> <span class="n">any</span> <span class="o">-&gt;</span> <span class="n">any</span> <span class="n">any</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">"Possible network interception detected"</span><span class="p">;</span> <span class="n">fragbits</span><span class="p">:</span> <span class="n">M</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">100004</span><span class="p">;</span> <span class="n">rev</span><span class="p">:</span><span class="mi">1</span><span class="p">;)</span>
</pre></table></code></div></div><li>Detecting Password/Login bruteforcing<div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">alert</span> <span class="n">tcp</span> <span class="n">any</span> <span class="n">any</span> <span class="o">-&gt;</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">42</span> <span class="mi">80</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">"Password/login attempt detected"</span><span class="p">;</span> <span class="n">content</span><span class="p">:</span><span class="s2">"POST"</span><span class="p">;</span> <span class="n">content</span><span class="p">:</span><span class="s2">"username"</span><span class="p">;</span> <span class="n">content</span><span class="p">:</span><span class="s2">"password"</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">100005</span><span class="p">;</span> <span class="n">rev</span><span class="p">:</span><span class="mi">1</span><span class="p">;)</span>
</pre></table></code></div></div><li>Detecting basic WiFi attack (DHCP Fingerprinting)<div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">alert</span> <span class="n">udp</span> <span class="n">any</span> <span class="n">any</span> <span class="o">-&gt;</span> <span class="n">any</span> <span class="mi">67</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">"Possible DHCP fingerprinting detected"</span><span class="p">;</span> <span class="n">content</span><span class="p">:</span><span class="s2">"|01 01 06|"</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">10006</span><span class="p">;)</span>
</pre></table></code></div></div><li>Detecting Custom Packet Generation on network<div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">alert</span> <span class="n">tcp</span> <span class="n">any</span> <span class="n">any</span> <span class="o">-&gt;</span> <span class="n">any</span> <span class="n">any</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">"Possible crafted TCP packet detected"</span><span class="p">;</span> <span class="n">flags</span><span class="p">:</span> <span class="n">AP</span><span class="p">;</span> <span class="n">dsize</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">10007</span><span class="p">;</span> <span class="n">rev</span><span class="p">:</span><span class="mi">1</span><span class="p">;)</span>
</pre></table></code></div></div><p>Finally, we can test these rules against Snort</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>snort <span class="nt">-c</span> /usr/local/etc/snort/snort.lua <span class="nt">-R</span> /usr/local/etc/rules/local.rules
</pre></table></code></div></div><p>To allow Snort to run according to these rules by default, go to line 182 of your <code class="language-plaintext highlighter-rouge">/usr/local/etc/snort/snort.lua</code> file and ensure the <code class="language-plaintext highlighter-rouge">ips</code> section to be as follows: ```lua ips = { – use this to enable decoder and inspector alerts</p></ol><p>enable_builtin_rules = true,</p><p>include = RULE_PATH .. “/local.rules”,</p><p>– use include for rules files; be sure to set your path – note that rules files can include other rules files – (see also related path vars at the top of snort_defaults.lua)</p><p>variables = default_variable }</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>Verify the configuration
```bash
snort -c /usr/local/etc/snort/snort.lua
</pre></table></code></div></div><p><strong>Configuring Logs</strong></p><p>There are a lot of options when it comes to the way you want Snort to log your events and errors. However, we will be using the <code class="language-plaintext highlighter-rouge">alert_fast</code> option to prevent noisy logs.</p><p>To do this, we can go to the <code class="language-plaintext highlighter-rouge">output section</code> of the <code class="language-plaintext highlighter-rouge">/usr/local/etc/snort/snort.lua</code> file and modify it so it looks like this</p><div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="c1">--------------------------------------------------------------------------</span>
<span class="c1">-- 7. configure outputs</span>
<span class="c1">--------------------------------------------------------------------------</span>
    
<span class="c1">-- event logging</span>
<span class="c1">-- you can enable with defaults from the command line with -A &lt;alert_type&gt;</span>
<span class="c1">-- uncomment below to set non-default configs</span>
<span class="n">alert_csv</span> <span class="o">=</span> <span class="p">{</span> <span class="p">}</span>
<span class="n">alert_fast</span> <span class="o">=</span> <span class="p">{</span><span class="n">file</span><span class="o">=</span><span class="kc">true</span><span class="p">,</span> <span class="n">packet</span><span class="o">=</span><span class="kc">false</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,}</span>
<span class="n">alert_full</span> <span class="o">=</span> <span class="p">{</span> <span class="p">}</span>
<span class="n">alert_sfsocket</span> <span class="o">=</span> <span class="p">{</span> <span class="p">}</span>
<span class="n">alert_syslog</span> <span class="o">=</span> <span class="p">{</span> <span class="p">}</span>
<span class="n">unified2</span> <span class="o">=</span> <span class="p">{</span> <span class="p">}</span>
    
<span class="c1">-- packet logging</span>
<span class="c1">-- you can enable with defaults from the command line with -L &lt;log_type&gt;</span>
<span class="n">log_codecs</span> <span class="o">=</span> <span class="p">{</span> <span class="p">}</span>
<span class="n">log_hext</span> <span class="o">=</span> <span class="p">{</span> <span class="p">}</span>
<span class="n">log_pcap</span> <span class="o">=</span> <span class="p">{</span> <span class="p">}</span>

<span class="c1">-- additional logs</span>
<span class="n">packet_capture</span> <span class="o">=</span> <span class="p">{</span> <span class="p">}</span>
<span class="n">file_log</span> <span class="o">=</span> <span class="p">{</span> <span class="p">}</span>
</pre></table></code></div></div><p>Finally, test the configuration</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>snort <span class="nt">-c</span> /usr/local/etc/snort/snort.lua
</pre></table></code></div></div><p><strong>Configuring Snort to run as a service</strong></p><p>In production environments, it is recommended to run Snort as a daemon instead of running it on the console. To run it as a daemon, we need to configure some settings.</p><p>First, we need to create a non-privileged and non-logon user for the Snort daemon</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>useradd <span class="nt">-r</span> <span class="nt">-s</span> /usr/sbin/nologin <span class="nt">-M</span> <span class="nt">-c</span> SNORT_IDS snort
</pre></table></code></div></div><p>Then, we need to grant Snort the rights to its logging directory.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo chmod</span> <span class="nt">-R</span> 5775 /var/log/snort
<span class="nb">sudo chown</span> <span class="nt">-R</span> snort:snort /var/log/snort
</pre></table></code></div></div><p>We need to create a service file for snort</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nano /etc/systemd/system/snort3.service
</pre></table></code></div></div><p>and add the following lines to it</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="o">[</span>Unit]
<span class="nv">Description</span><span class="o">=</span>Snort3 NIDS Daemon
<span class="nv">After</span><span class="o">=</span>syslog.target network.target
<span class="o">[</span>Service]
<span class="nv">Type</span><span class="o">=</span>simple
<span class="nv">ExecStart</span><span class="o">=</span>/usr/local/bin/snort <span class="nt">-c</span> /usr/local/etc/snort/snort.lua <span class="nt">-s65535</span> <span class="nt">-k</span> none <span class="nt">-l</span> /var/log/snort <span class="nt">-D</span> <span class="nt">-u</span> snort <span class="nt">-g</span> snort <span class="nt">-i</span> eth0 <span class="nt">-m</span> 0x1b--create-pidfile
<span class="nv">ExecStop</span><span class="o">=</span>/bin/kill <span class="nt">-9</span> <span class="nv">$MAINPID</span>
<span class="o">[</span>Install]
<span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
</pre></table></code></div></div><p>Finally, we need to enable and start the Snort service</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl <span class="nb">enable </span>snort3
<span class="nb">sudo </span>service snort3 start
</pre></table></code></div></div><p>We can check the status of the Snort daemon as follows:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>service snort3 status
● snort3.service - Snort3 NIDS Daemon
     Loaded: loaded <span class="o">(</span>/etc/systemd/system/snort3.service<span class="p">;</span> enabled<span class="p">;</span>preset: disabled<span class="o">)</span>
     Active: active <span class="o">(</span>running<span class="o">)</span> since Sun 2023-03-26 07:42:17 EDT<span class="p">;</span> 3s ago
   Main PID: 4810 <span class="o">(</span>snort<span class="o">)</span>
      Tasks: 2 <span class="o">(</span>limit: 9440<span class="o">)</span>
     Memory: 61.9M
        CPU: 259ms
     CGroup: /system.slice/snort3.service
             └─4810 /usr/local/bin/snort <span class="nt">-c</span> /usr/local/etc/snort/snortlua <span class="nt">-s</span> 65535 <span class="nt">-k</span> none <span class="nt">-l</span> /var/log/snort <span class="nt">-D</span> <span class="nt">-u</span> <span class="o">&gt;</span>
    
Mar 26 07:42:17 kali systemd[1]: Started snort3.service - Snort3 NIDS Daemon.
</pre></table></code></div></div><p>Great! Now that we have Snort up and running, we can start testing the rules we made.</p><h2 id="testing-our-rules-optional-but-recommended"><span class="mr-2"><strong>Testing our Rules (Optional but Recommended)</strong></span><a href="#testing-our-rules-optional-but-recommended" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Testing your rules is a must before adding them to your IDS in a production environment. This helps ensure that the rules are properly tuned and have no negative affect.</p><p>We can look at alerts generated by Snort (in real-time) with the following command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">tail</span> <span class="nt">-f</span> /var/log/snort/alert_fast.txt
</pre></table></code></div></div><p>Here are the IP addresses assigned to my machines (for your reference):</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>192.168.1.22 <span class="c">#attacker machine</span>
192.168.1.42 <span class="c">#victim/web server</span>
</pre></table></code></div></div><p><strong>Rule#1:</strong></p><p>Detecting a SYN Flood (DoS/DDoS) attack:</p><div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">alert</span> <span class="n">tcp</span> <span class="n">any</span> <span class="n">any</span> <span class="o">-&gt;</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">42</span> <span class="mi">80</span> <span class="p">(</span><span class="n">flags</span><span class="p">:</span><span class="n">S</span><span class="p">;</span> <span class="n">detection_filter</span><span class="p">:</span> <span class="n">track</span> <span class="n">by_src</span><span class="p">,</span> <span class="n">count</span> <span class="mi">100</span><span class="p">,</span> <span class="n">seconds</span> <span class="mi">10</span><span class="p">;</span> <span class="n">msg</span><span class="p">:</span><span class="s2">"Possible SYN Flood Attack"</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">1000001</span><span class="p">;)</span>
</pre></table></code></div></div><p>To test this rule, we can use a simple <code class="language-plaintext highlighter-rouge">hping3</code> command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>hping3 <span class="nt">--flood</span> <span class="nt">-S</span> <span class="nt">-p</span> 80 192.168.1.42  
</pre></table></code></div></div><p>This will generate the following alerts:</p><p><a href="https://cdn-images-1.medium.com/max/2000/1*vl9ihwZNVi6xlvoylLDpNA.png" class="popup img-link "><img data-src="https://cdn-images-1.medium.com/max/2000/1*vl9ihwZNVi6xlvoylLDpNA.png" alt="Testing DoS/DDoS Rule" class="lazyload" data-proofer-ignore></a><em>Testing DoS/DDoS Rule</em></p><p><strong>Rule#2:</strong></p><p>Detecting an injection attack on your web server:</p><div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">alert</span> <span class="n">tcp</span> <span class="n">any</span> <span class="n">any</span> <span class="o">-&gt;</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">42</span> <span class="mi">80</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">"Possible SQL injection attack detected"</span><span class="p">;</span> <span class="n">flow</span><span class="p">:</span><span class="n">to_server</span><span class="p">,</span><span class="n">established</span><span class="p">;</span> <span class="n">content</span><span class="p">:</span> <span class="s2">"%27"</span> <span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">100002</span><span class="p">;</span> <span class="n">rev</span><span class="p">:</span><span class="mi">1</span><span class="p">;)</span>
</pre></table></code></div></div><p>First, we need to create a test website and host it on an apache server. We can do this by creating a file called index.php in the /var/www/html/ directory and adding the following contents to it:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>Test Page<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">""</span> <span class="na">method=</span><span class="s">"GET"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"id"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">value=</span><span class="s">"Submit"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></table></code></div></div><p>We can then start our apache server with the following command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl restart apache2
</pre></table></code></div></div><p>To test this rule, we can use the <code class="language-plaintext highlighter-rouge">curl</code> command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl <span class="s2">"http://192.168.1.42/index.php?id=%27OR"</span> <span class="nt">-v</span>
</pre></table></code></div></div><p>This will generate the following alert:</p><p><a href="https://cdn-images-1.medium.com/max/2000/1*XD80zVRjK7mHO0lEjAD7sg.png" class="popup img-link "><img data-src="https://cdn-images-1.medium.com/max/2000/1*XD80zVRjK7mHO0lEjAD7sg.png" alt="Testing SQL Injection Rule" class="lazyload" data-proofer-ignore></a><em>Testing SQL Injection Rule</em></p><p><strong>Rule#3:</strong></p><p>Detecting port scanning activity on your network:</p><div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">alert</span> <span class="n">tcp</span> <span class="n">any</span> <span class="n">any</span> <span class="o">-&gt;</span> <span class="n">any</span> <span class="n">any</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">"Port scanning detected"</span><span class="p">;</span> <span class="n">flags</span><span class="p">:</span><span class="n">S</span><span class="p">;</span> <span class="n">detection_filter</span><span class="p">:</span><span class="n">track</span> <span class="n">by_src</span><span class="p">,</span> <span class="n">count</span> <span class="mi">3</span><span class="p">,</span> <span class="n">seconds</span> <span class="mi">10</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">100003</span><span class="p">;</span> <span class="n">rev</span><span class="p">:</span><span class="mi">1</span><span class="p">;)</span>
</pre></table></code></div></div><p>Since this rule only detects SYN scans, we can use the following <code class="language-plaintext highlighter-rouge">nmap</code> command to test it:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nmap <span class="nt">-sS</span> 192.168.1.42
</pre></table></code></div></div><p>This will generate the following alert:</p><p><a href="https://cdn-images-1.medium.com/max/2000/1*tPTiIy4rPz5hzWNsTZSv9A.png" class="popup img-link "><img data-src="https://cdn-images-1.medium.com/max/2000/1*tPTiIy4rPz5hzWNsTZSv9A.png" alt="Testing SYN Scanning Rule" class="lazyload" data-proofer-ignore></a><em>Testing SYN Scanning Rule</em></p><p><strong>Rule#4:</strong></p><p>Detecting network interception attempts:</p><div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">alert</span> <span class="n">ip</span> <span class="n">any</span> <span class="n">any</span> <span class="o">-&gt;</span> <span class="n">any</span> <span class="n">any</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">"Possible network interception detected"</span><span class="p">;</span> <span class="n">fragbits</span><span class="p">:</span> <span class="n">M</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">100004</span><span class="p">;</span> <span class="n">rev</span><span class="p">:</span><span class="mi">1</span><span class="p">;)</span>
</pre></table></code></div></div><p>We can use the following <code class="language-plaintext highlighter-rouge">hping3</code> command to generate fragmented packets:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>hping3 192.168.1.42 <span class="nt">-c</span> 5 <span class="nt">-d</span> 1500 <span class="nt">-F</span> <span class="nt">-f</span> 
</pre></table></code></div></div><p>This will generate the following output:</p><p><a href="https://cdn-images-1.medium.com/max/2000/1*ushJpA63-fEl35Np24LHHg.png" class="popup img-link "><img data-src="https://cdn-images-1.medium.com/max/2000/1*ushJpA63-fEl35Np24LHHg.png" alt="Testing Network Interception Rule" class="lazyload" data-proofer-ignore></a><em>Testing Network Interception Rule</em></p><p><strong>Rule#5:</strong></p><p>Detecting login attempts on your web server:</p><div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">alert</span> <span class="n">tcp</span> <span class="n">any</span> <span class="n">any</span> <span class="o">-&gt;</span> <span class="mi">192</span><span class="p">.</span><span class="mi">168</span><span class="p">.</span><span class="mi">1</span><span class="p">.</span><span class="mi">42</span> <span class="mi">80</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">"Password/login attempt detected"</span><span class="p">;</span> <span class="n">content</span><span class="p">:</span><span class="s2">"POST"</span><span class="p">;</span> <span class="n">content</span><span class="p">:</span><span class="s2">"username"</span><span class="p">;</span> <span class="n">content</span><span class="p">:</span><span class="s2">"password"</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">100005</span><span class="p">;</span> <span class="n">rev</span><span class="p">:</span><span class="mi">1</span><span class="p">;)</span>
</pre></table></code></div></div><p>To test this rule, we first need to create an api endpoint <code class="language-plaintext highlighter-rouge">login.php</code> in our <code class="language-plaintext highlighter-rouge">/var/www/html</code> directory. We can use the following test endpoint:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>

<span class="nb">session_start</span><span class="p">();</span>

<span class="nv">$username</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'username'</span><span class="p">];</span>
<span class="nv">$password</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'password'</span><span class="p">];</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$username</span> <span class="o">===</span> <span class="s1">'admin'</span> <span class="o">&amp;&amp;</span> <span class="nv">$password</span> <span class="o">===</span> <span class="s1">'password123'</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'admin'</span><span class="p">;</span>
  <span class="nb">header</span><span class="p">(</span><span class="s1">'Location: /dashboard.php'</span><span class="p">);</span>
  <span class="k">exit</span><span class="p">();</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="s1">'Invalid username or password.'</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>We can restart our Apache server with the following command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl restart apache2
</pre></table></code></div></div><p>To test this rule, we can use the <code class="language-plaintext highlighter-rouge">curl</code> command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>curl <span class="nt">-d</span> <span class="s2">"username=test&amp;password=invalid"</span> <span class="nt">-X</span> POST http://192.168.1.42/login.php
</pre></table></code></div></div><p>This will generate the following alert:</p><p><a href="https://cdn-images-1.medium.com/max/2000/1*TGMfYthgiShOCBkttv3uaw.png" class="popup img-link "><img data-src="https://cdn-images-1.medium.com/max/2000/1*TGMfYthgiShOCBkttv3uaw.png" alt="Testing Login attempt Rule" class="lazyload" data-proofer-ignore></a><em>Testing Login attempt Rule</em></p><p><strong>Rule#6:</strong></p><p>Detecting DHCP Fingerprinting:</p><div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">alert</span> <span class="n">udp</span> <span class="n">any</span> <span class="n">any</span> <span class="o">-&gt;</span> <span class="n">any</span> <span class="mi">67</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">"Possible DHCP fingerprinting detected"</span><span class="p">;</span> <span class="n">content</span><span class="p">:</span><span class="s2">"|01 01 06|"</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">10006</span><span class="p">;)</span>
</pre></table></code></div></div><p>To test this rule, we can create a file called <code class="language-plaintext highlighter-rouge">dhcp_packet.raw</code> and add the contents <code class="language-plaintext highlighter-rouge">01 01 06</code> to it. Then we can use the following <code class="language-plaintext highlighter-rouge">hping3</code> command to send a DHCP request to the victim server:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>hping3 <span class="nt">-2</span> <span class="nt">-c</span> 1 <span class="nt">-p</span> 67 <span class="nt">-s</span> 68 <span class="nt">-d</span> <span class="s1">'010106'</span> <span class="nt">-E</span> dhcp_packet.raw 192.168.1.42
</pre></table></code></div></div><p>This will generate the following alert:</p><p><a href="https://cdn-images-1.medium.com/max/2000/1*p8OA2SuTE3AmXEYwX0Twaw.png" class="popup img-link "><img data-src="https://cdn-images-1.medium.com/max/2000/1*p8OA2SuTE3AmXEYwX0Twaw.png" alt="Testing DHCP Fingerprinting Rule" class="lazyload" data-proofer-ignore></a><em>Testing DHCP Fingerprinting Rule</em></p><p><strong>Rule#7:</strong></p><p>Detecting crafted packet in network:</p><div class="language-lua highlighter-rouge"><div class="code-header"> <span data-label-text="Lua"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">alert</span> <span class="n">tcp</span> <span class="n">any</span> <span class="n">any</span> <span class="o">-&gt;</span> <span class="n">any</span> <span class="n">any</span> <span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="s2">"Possible crafted TCP packet detected"</span><span class="p">;</span> <span class="n">flags</span><span class="p">:</span> <span class="n">AP</span><span class="p">;</span> <span class="n">dsize</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span> <span class="n">sid</span><span class="p">:</span><span class="mi">10007</span><span class="p">;</span> <span class="n">rev</span><span class="p">:</span><span class="mi">1</span><span class="p">;)</span>
</pre></table></code></div></div><p>This this specific rule tests for a crafted packet with the ACK and PSH flags set, we can use the following <code class="language-plaintext highlighter-rouge">hping3</code> command to test it:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>hping3 <span class="nt">-c</span> 1 <span class="nt">-A</span> <span class="nt">-P</span> <span class="nt">-p</span> 80 <span class="nt">--data</span> 0 192.168.1.42 
</pre></table></code></div></div><p>This will generate the following alert:</p><p><a href="https://cdn-images-1.medium.com/max/2000/1*XHLY2DK3VCGpoTiVbXAYvw.png" class="popup img-link "><img data-src="https://cdn-images-1.medium.com/max/2000/1*XHLY2DK3VCGpoTiVbXAYvw.png" alt="Testing Crafted TCP packet rule" class="lazyload" data-proofer-ignore></a><em>Testing Crafted TCP packet rule</em></p><h2 id="conclusion"><span class="mr-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Snort is an extremely powerful, open-source solution for intrusion detection. They say “when life gives you lemons, make lemonade”. How this saying relates to our topic is that no matter how tedious it might seem to configure Snort, it will help protect your organization from thousands of attacks if you tune and monitor it properly.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blogs/'>Blogs</a>, <a href='/categories/network-security/'>Network Security</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/network-security/" class="post-tag no-text-decoration" >network security</a> <a href="/tags/intrusion-detection/" class="post-tag no-text-decoration" >intrusion detection</a> <a href="/tags/idps/" class="post-tag no-text-decoration" >idps</a> <a href="/tags/ids/" class="post-tag no-text-decoration" >ids</a> <a href="/tags/insider-threats/" class="post-tag no-text-decoration" >insider threats</a> <a href="/tags/attacks/" class="post-tag no-text-decoration" >attacks</a> <a href="/tags/cyber-defense/" class="post-tag no-text-decoration" >cyber defense</a> <a href="/tags/for-dummies/" class="post-tag no-text-decoration" >for dummies</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Snort%20for%20Dummies!%20-%20Abdullah%20Irfan&url=https%3A%2F%2Fdingavinga1.github.io%2Fposts%2FSnort-for-Dummies%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Snort%20for%20Dummies!%20-%20Abdullah%20Irfan&u=https%3A%2F%2Fdingavinga1.github.io%2Fposts%2FSnort-for-Dummies%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fdingavinga1.github.io%2Fposts%2FSnort-for-Dummies%2F&text=Snort%20for%20Dummies!%20-%20Abdullah%20Irfan" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fdingavinga1.github.io%2Fposts%2FSnort-for-Dummies%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cloud-computing/">cloud computing</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/for-dummies/">for dummies</a> <a class="post-tag" href="/tags/iaas/">IaaS</a> <a class="post-tag" href="/tags/network-security/">network security</a> <a class="post-tag" href="/tags/abstraction/">abstraction</a> <a class="post-tag" href="/tags/aspdotnet/">aspdotnet</a> <a class="post-tag" href="/tags/attacks/">attacks</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/cloud-functions/">cloud functions</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/OpenSSL-for-Dummies/"><div class="card-body"> <em class="small" data-ts="1681592400" data-df="ll" > Apr 16, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>OpenSSL for Dummies!</h3><div class="text-muted small"><p> What is OpenSSL? OpenSSL is an open-source tool for cryptography- mainly SSL and TLS. It is a powerful tool when and supports all kinds of functionalities- from key generation to client/server test...</p></div></div></a></div><div class="card"> <a href="/posts/Built-Your-Very-Own-Cloud-Storage-Right-Now!/"><div class="card-body"> <em class="small" data-ts="1683666000" data-df="ll" > May 10, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Build your Very Own Cloud Storage Right Now!</h3><div class="text-muted small"><p> Introduction When working in an organization or as a freelancer, one always faces an issue with file storage. There are millions of documents, images and important files that you need to store and ...</p></div></div></a></div><div class="card"> <a href="/posts/Setting-up-your-own-Beowulf-Cluster-on-Docker-as-a-PoC/"><div class="card-body"> <em class="small" data-ts="1694155440" data-df="ll" > Sep 8, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Setting up your own Beowulf Cluster on Docker as a PoC</h3><div class="text-muted small"><p> Why? Due to the ever-evolving world of information technology, computational needs are increasing day by day while the ability to miniaturize processors is about to reach its cap. That is where par...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/OpenSSL-for-Dummies/" class="btn btn-outline-primary" prompt="Older"><p>OpenSSL for Dummies!</p></a> <a href="/posts/Built-Your-Very-Own-Cloud-Storage-Right-Now!/" class="btn btn-outline-primary" prompt="Newer"><p>Build your Very Own Cloud Storage Right Now!</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cloud-computing/">cloud computing</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/for-dummies/">for dummies</a> <a class="post-tag" href="/tags/iaas/">IaaS</a> <a class="post-tag" href="/tags/network-security/">network security</a> <a class="post-tag" href="/tags/abstraction/">abstraction</a> <a class="post-tag" href="/tags/aspdotnet/">aspdotnet</a> <a class="post-tag" href="/tags/attacks/">attacks</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/cloud-functions/">cloud functions</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://github.com/dingavinga1">Abdullah Irfan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1.11.6/dayjs.min.js,npm/dayjs@1.11.6/locale/en.min.js,npm/dayjs@1.11.6/plugin/relativeTime.min.js,npm/dayjs@1.11.6/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
